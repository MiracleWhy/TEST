<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.uton.carsokApi.dao.AcquisitionCarMapper" >
    <resultMap id="BaseResultMap" type="com.uton.carsokApi.model.AcquisitionCar" >
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <result column="id" property="id" jdbcType="INTEGER" />
        <result column="carInspectionTime" property="carInspectionTime" jdbcType="TIMESTAMP" />
        <result column="collectionType" property="collectionType" jdbcType="VARCHAR" />
        <result column="customerName" property="customerName" jdbcType="VARCHAR" />
        <result column="contentNum" property="contentNum" jdbcType="VARCHAR" />
        <result column="preferPrice" property="preferPrice" jdbcType="DECIMAL" />
        <result column="infoRecourse" property="infoRecourse" jdbcType="VARCHAR" />
        <result column="collectionArea" property="collectionArea" jdbcType="VARCHAR" />
        <result column="consultPrice" property="consultPrice" jdbcType="VARCHAR" />
        <result column="isDeal" property="isDeal" jdbcType="BIT" />
        <result column="closeingPrice" property="closeingPrice" jdbcType="DECIMAL" />
        <result column="remark" property="remark" jdbcType="VARCHAR" />
        <result column="vin" property="vin" jdbcType="VARCHAR" />
        <result column="brand" property="brand" jdbcType="VARCHAR" />
        <result column="card_time" property="cardTime" jdbcType="VARCHAR" />
        <result column="account_id" property="accountId" jdbcType="INTEGER" />
        <result column="child_id" property="childId" jdbcType="INTEGER" />
        <result column="first_up_time" property="firstUpTime" jdbcType="TIMESTAMP" />
        <result column="product_id" property="productId" jdbcType="INTEGER" />
        <result column="create_time" property="createTime" jdbcType="TIMESTAMP" />
        <result column="enable" property="enable" jdbcType="INTEGER" />
        <result column="alias" property="alias" jdbcType="VARCHAR" />
        <result column="childPhone" property="childPhone" jdbcType="VARCHAR" />
        <result column="account" property="account" jdbcType="VARCHAR" />
        <result column="maintenance" property="maintenance" jdbcType="VARCHAR" />
        <result column="evaluate" property="evaluate" jdbcType="VARCHAR" />
        <result column="closedcarcontract" property="closedcarcontract" jdbcType="VARCHAR" />
        <result column="evaluatePrice" property="evaluatePrice" jdbcType="VARCHAR" />
        <result column="color" property="color" jdbcType="VARCHAR" />
        <result column="car_pics" property="carPicString" jdbcType="VARCHAR" />
    </resultMap>

    <resultMap id="BaseResultMap2" type="com.uton.carsokApi.model.AcquisitionConsult" >
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <result column="id" property="id" jdbcType="INTEGER" />
        <result column="acquisition_id" property="acquisitionId" jdbcType="INTEGER" />
        <result column="consult_price" property="consultPrice" jdbcType="DECIMAL" />
        <result column="create_time" property="createTime" jdbcType="TIMESTAMP" />
    </resultMap>

    <resultMap id="BaseResultMap3" type="com.uton.carsokApi.controller.response.CollectIdentityResponse">
        <result column="power_name" property="powerName" jdbcType="VARCHAR" />
    </resultMap>
    <sql id="Base_Column_List">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        id,
        carInspectionTime,
        collectionType,
        customerName,
        contentNum,
        preferPrice,
        infoRecourse,
        collectionArea,
        lastPrice,
        isDeal,
        closeingPrice,
        remark,
        account_id,
        child_id,
        product_id,
        vin,
        create_time,
        enable,
        first_up_time

    </sql>
    <select id="selectAcquisitionCar" parameterType="java.util.Map">
        SELECT <include refid="Base_Column_List"/>
        FROM carsok_acquisition_car cac
        WHERE cac.preferPrice = #{infoRecourse}
    </select>
    <insert id="insertMessage" useGeneratedKeys="true" keyProperty="id">
        insert into carsok_acquisition_car
        <trim prefix="(" suffix=")" suffixOverrides="," >
            <if test="id != null" >
                id,
            </if>
            <if test="carInspectionTime != null" >
                carInspectionTime,
            </if>
            <if test="collectionType != null" >
                collectionType,
            </if>
            <if test="customerName != null" >
                customerName,
            </if>
            <if test="contentNum != null" >
                contentNum,
            </if>
            <if test="preferPrice != null" >
                preferPrice,
            </if>
            <if test="infoRecourse != null" >
                infoRecourse,
            </if>
            <if test="collectionArea != null" >
                collectionArea,
            </if>
            <if test="consultPrice != null" >
                consultPrice,
            </if>
            <if test="isDeal != null" >
                isDeal,
            </if>
            <if test="closeingPrice != null" >
                closeingPrice,
            </if>
            <if test="remark != null" >
                remark,
            </if>
            <if test="accountId != null" >
                account_id,
            </if>
            <if test="childId != null" >
                child_id,
            </if>
            <if test="createTime != null" >
                create_time,
            </if>
            <if test="enable != null" >
                enable,
            </if>
            <if test="firstUpTime != null">
                first_up_time,
            </if>
            <if test="vin != null" >
                vin,
            </if>
            <if test="brand != null" >
                brand,
            </if>
            <if test="cardTime != null" >
                card_time,
            </if>
            <if test="maintenance != null" >
                maintenance,
            </if>

            <if test="evaluate != null" >
                evaluate,
            </if>

            <if test="closedcarcontract != null" >
                closedcarcontract,
            </if>
            <if test="evaluatePrice != null" >
                evaluatePrice,
            </if>
            <if test="carPicString != null" >
                car_pics,
            </if>
            <if test="color != null" >
                color,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides="," >
            <if test="id != null" >
                #{id,jdbcType=INTEGER},
            </if>
            <if test="carInspectionTime != null" >
                #{carInspectionTime,jdbcType=TIMESTAMP},
            </if>
            <if test="collectionType != null" >
                #{collectionType,jdbcType=VARCHAR},
            </if>
            <if test="customerName != null" >
                #{customerName,jdbcType=VARCHAR},
            </if>
            <if test="contentNum != null" >
                #{contentNum,jdbcType=VARCHAR},
            </if>
            <if test="preferPrice != null" >
                #{preferPrice,jdbcType=DECIMAL},
            </if>
            <if test="infoRecourse != null" >
                #{infoRecourse,jdbcType=VARCHAR},
            </if>
            <if test="collectionArea != null" >
                #{collectionArea,jdbcType=VARCHAR},
            </if>
            <if test="consultPrice != null" >
                #{consultPrice,jdbcType=DECIMAL},
            </if>
            <if test="isDeal != null" >
                #{isDeal,jdbcType=INTEGER},
            </if>
            <if test="closeingPrice != null" >
                #{closeingPrice,jdbcType=DECIMAL},
            </if>
            <if test="remark != null" >
                #{remark,jdbcType=VARCHAR},
            </if>
            <if test="accountId != null" >
                #{accountId,jdbcType=INTEGER},
            </if>
            <if test="childId != null" >
                #{childId,jdbcType=INTEGER},
            </if>
            <if test="createTime != null" >
                #{createTime,jdbcType=TIMESTAMP},
            </if>
            <if test="enable != null" >
                #{enable,jdbcType=INTEGER},
            </if>
            <if test="firstUpTime != null">
                #{firstUpTime,jdbcType=TIMESTAMP},
            </if>
            <if test="vin != null" >
                #{vin,jdbcType=VARCHAR},
            </if>
            <if test="brand != null" >
                #{brand,jdbcType=VARCHAR},
            </if>
            <if test="cardTime != null" >
                #{cardTime,jdbcType=VARCHAR},
            </if>
            <if test="maintenance != null" >
                #{maintenance,jdbcType=VARCHAR},
            </if>
            <if test="evaluate != null" >
                #{evaluate,jdbcType=VARCHAR},
            </if>
            <if test="closedcarcontract != null" >
                #{closedcarcontract,jdbcType=VARCHAR},
            </if>
            <if test="evaluatePrice != null" >
                #{evaluatePrice,jdbcType=VARCHAR},
            </if>
            <if test="carPicString != null" >
                #{carPicString,jdbcType=VARCHAR},
            </if>
            <if test="color != null" >
                #{color,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>
    <insert id="insertConsult">
        INSERT INTO carsok_acquisition_consult
        <trim prefix="(" suffix=")" suffixOverrides="," >
            <if test="id != null" >
                id,
            </if>
            <if test="acquisitionId != null and acquisitionId != ''" >
                acquisition_id,
            </if>
            <if test="consultPrice != null" >
                consult_price,
            </if>
            <if test="createTime != null" >
                create_time,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides="," >
            <if test="id != null" >
                #{id,jdbcType=INTEGER},
            </if>
            <if test="acquisitionId != null and acquisitionId != ''" >
                #{acquisitionId,jdbcType=INTEGER},
            </if>
            <if test="consultPrice != null" >
                #{consultPrice,jdbcType=DECIMAL},
            </if>
            <if test="createTime != null" >
                #{createTime,jdbcType=TIMESTAMP},
            </if>
        </trim>
    </insert>
    <insert id="insertPricingInfo">
        INSERT INTO carsok_acquisition_car_pricing
        <trim prefix="(" suffix=")" suffixOverrides="," >
            <if test="id != null" >
                id,
            </if>
            <if test="acquisitionCarId != null and acquisitionCarId != ''" >
                acquisition_car_id,
            </if>
            <if test="pricingInfo != null" >
                pricing_info,
            </if>
            <if test="createTime != null" >
                create_time,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides="," >
            <if test="id != null" >
                #{id,jdbcType=INTEGER},
            </if>
            <if test="acquisitionCarId != null and acquisitionCarId != ''" >
                #{acquisitionCarId,jdbcType=INTEGER},
            </if>
            <if test="pricingInfo != null" >
                #{pricingInfo,jdbcType=VARCHAR},
            </if>
            <if test="createTime != null" >
                #{createTime,jdbcType=TIMESTAMP},
            </if>
        </trim>
    </insert>
    <select id="selectAcquisitionMsg" resultMap="BaseResultMap">
        SELECT *
        from carsok_acquisition_car
        <if test="childId == 0">
            WHERE account_id = #{accountId}
        </if>
        <if test="childId != 0">
            WHERE account_id = #{accountId} and child_id = #{childId}
        </if>
        <if test="xxly != '' and xxly != null">
            and infoRecourse = #{xxly}
        </if>
        <if test="ycsj == 1">
            and DATE_FORMAT(carInspectionTime, '%Y-%m-%d') = (DATE_FORMAT(NOW(), '%Y-%m-%d'))
        </if>
        <if test="ycsj == 2">
            and carInspectionTime BETWEEN DATE_FORMAT(DATE_SUB(NOW(),INTERVAL WEEKDAY(NOW()) DAY),'%Y-%m-%d') AND DATE_FORMAT(DATE_SUB(CURDATE(),INTERVAL -1 DAY) ,'%Y-%m-%d')
        </if>
        <if test="ycsj == 3">
            and DATE_FORMAT(carInspectionTime, '%Y-%m') = (DATE_FORMAT(NOW(), '%Y-%m'))
        </if>
        <if test="isDeal == null and isDeal == ''">
            and isDeal = 0
        </if>
        <if test="isDeal != null and isDeal != ''">
            and isDeal = #{isDeal}
        </if>
        <if test="px == 1">
            order BY preferPrice DESC
        </if>
        <if test="px == 2">
            order BY preferPrice
        </if>
        <if test="px == null or px == ''">
            ORDER BY id DESC
        </if>
        limit #{p1},#{p2}
    </select>
    <select id="selectCount" resultType="java.lang.Integer">
        SELECT COUNT(*)
        from carsok_acquisition_car
        <if test="childId == 0">
            WHERE account_id = #{accountId}
        </if>
        <if test="childId != 0">
            WHERE account_id = #{accountId} and child_id = #{childId}
        </if>
        <if test="isDeal != null and isDeal != ''">
            AND isDeal = #{isDeal}
        </if>
    </select>
    <select id="selectdealY" resultType="java.lang.Integer">
        SELECT COUNT(*) from carsok_acquisition_car
        <if test="childId == 0">
            WHERE account_id = #{accountId}
        </if>
        <if test="childId != 0">
            WHERE account_id = #{accountId} and child_id = #{childId}
        </if>
        and isDeal = 1
    </select>
    <select id="selectdealN" resultType="java.lang.Integer">
        SELECT COUNT(*) from carsok_acquisition_car
        <if test="childId == 0">
            WHERE account_id = #{accountId}
        </if>
        <if test="childId != 0">
            WHERE account_id = #{accountId} and child_id = #{childId}
        </if>
        and isDeal = 2
    </select>
    <select id="selectdealF" resultType="java.lang.Integer">
        SELECT COUNT(*) from carsok_acquisition_car
        <if test="childId == 0">
            WHERE account_id = #{accountId}
        </if>
        <if test="childId != 0">
            WHERE account_id = #{accountId} and child_id = #{childId}
        </if>
        and isDeal = 3
    </select>
    <select id="selectScreenCount" resultType="java.lang.Integer">
        SELECT count(*) from carsok_acquisition_car
        <if test="childId == 0">
            where account_id = #{accountId}
        </if>
        <if test="childId != 0">
            where account_id = #{accountId} and child_id = #{childId}
        </if>
        <if test="xxly != '' and xxly != null">
            and infoRecourse = #{xxly}
        </if>
        <if test="ycsj == 1">
            and DATE_FORMAT(carInspectionTime, '%Y-%m-%d') = (DATE_FORMAT(NOW(), '%Y-%m-%d'))
        </if>
        <if test="ycsj == 2">
            and carInspectionTime BETWEEN DATE_FORMAT(DATE_SUB(NOW(),INTERVAL WEEKDAY(NOW()) DAY),'%Y-%m-%d') AND DATE_FORMAT(DATE_SUB(CURDATE(),INTERVAL -1 DAY) ,'%Y-%m-%d')
        </if>
        <if test="ycsj == 3">
            and DATE_FORMAT(carInspectionTime, '%Y-%m') = (DATE_FORMAT(NOW(), '%Y-%m'))
        </if>
    </select>
    <select id="ScreenMessageAll" resultMap="BaseResultMap">
        SELECT * from carsok_acquisition_car
        <if test="childId == 0">
            where account_id = #{accountId}
        </if>
        <if test="childId != 0">
            where account_id = #{accountId} and child_id = #{childId}
        </if>
        <if test="xxly != '' and xxly != null">
            and infoRecourse = #{xxly}
        </if>
        <if test="ycsj == 1">
            and DATE_FORMAT(carInspectionTime, '%Y-%m-%d') = (DATE_FORMAT(NOW(), '%Y-%m-%d'))
        </if>
        <if test="ycsj == 2">
            and carInspectionTime BETWEEN DATE_FORMAT(DATE_SUB(NOW(),INTERVAL WEEKDAY(NOW()) DAY),'%Y-%m-%d') AND DATE_FORMAT(DATE_SUB(CURDATE(),INTERVAL -1 DAY) ,'%Y-%m-%d')
        </if>
        <if test="ycsj == 3">
            and DATE_FORMAT(carInspectionTime, '%Y-%m') = (DATE_FORMAT(NOW(), '%Y-%m'))
        </if>
        <if test="isDeal == null and isDeal == ''">
            and 1 = 1
        </if>
        <if test="isDeal != null and isDeal != ''">
            and isDeal = #{isDeal}
        </if>
        <if test="px == 1">
            order BY preferPrice DESC
        </if>
        <if test="px == 2">
            order BY preferPrice
        </if>
        <if test="px == null or px == ''">
            ORDER BY id DESC
        </if>
        LIMIT #{p1},#{p2}
    </select>
    <select id="selectBySearchKey" resultType="java.lang.Integer">
        SELECT count(*) from carsok_acquisition_car
        where customerName LIKE CONCAT('%',#{selects},'%')
        OR contentNum LIKE CONCAT('%',#{selects},'%')
        OR collectionType LIKE CONCAT('%',#{selects},'%')
        <if test="childId == 0">
            AND account_id = #{accountId}
        </if>
        <if test="childId != 0">
            AND account_id = #{accountId} and child_id = #{childId}
        </if>
    </select>
    <select id="queryBysearchkey" resultMap="BaseResultMap">
        SELECT * from carsok_acquisition_car
        <if test="childId == 0">
            where account_id = #{accountId}
        </if>
        <if test="childId != 0">
            where account_id = #{accountId} and child_id = #{childId}
        </if>
        <if test="selects != null and selects != '' ">
            AND ( customerName LIKE CONCAT('%',#{selects},'%')
            OR contentNum LIKE CONCAT('%',#{selects},'%')
            OR collectionType LIKE CONCAT('%',#{selects},'%') )
        </if>
        ORDER BY id DESC
        LIMIT #{p1},#{p2}
    </select>
    <select id="selectMsgById" parameterType="java.lang.Integer" resultMap="BaseResultMap">
        SELECT * FROM carsok_acquisition_car
        WHERE id = #{id}
    </select>
    <select id="selectPricingInfo" parameterType="java.lang.Integer" resultType="com.uton.carsokApi.model.AcquisitionCarPricing">
        SELECT a.id AS id, a.pricing_info AS pricingInfo, a.acquisition_car_id AS acquisitionCarId, DATE_FORMAT(a.create_time, '%Y-%m-%d %H:%i:%s') AS createTime
        FROM carsok_acquisition_car_pricing a
        WHERE a.acquisition_car_id = #{id}
    </select>
    <select id="selectConsultById" parameterType="java.lang.Integer" resultMap="BaseResultMap2">
        SELECT * FROM carsok_acquisition_consult
        WHERE acquisition_id = #{id}
    </select>
    <update id="updateAcquisitionCar" parameterType="com.uton.carsokApi.model.AcquisitionCar">
        UPDATE carsok_acquisition_car
        <set>
            <if test="collectionType != null">
                collectionType = #{collectionType, jdbcType=VARCHAR},
            </if>
            <if test="customerName != null">
                customerName = #{customerName,jdbcType=VARCHAR},
            </if>
            <if test="contentNum != null">
                contentNum = #{contentNum,jdbcType=VARCHAR},
            </if>
            <if test="preferPrice != null">
                preferPrice = #{preferPrice,jdbcType=DECIMAL},
            </if>
            <if test="infoRecourse != null">
                infoRecourse = #{infoRecourse,jdbcType=VARCHAR},
            </if>
            <if test="collectionArea != null">
                collectionArea = #{collectionArea,jdbcType=VARCHAR },
            </if>
            <if test="consultPrice != null">
                consultPrice = #{consultPrice,jdbcType=DECIMAL},
            </if>
            <if test="isDeal != null">
                isDeal = #{isDeal,jdbcType=INTEGER},
            </if>
            <if test="closeingPrice != null">
                closeingPrice = #{closeingPrice,jdbcType=DECIMAL},
            </if>
            <if test="remark != null">
                remark = #{remark,jdbcType=VARCHAR},
            </if>
            <if test="enable != null">
                enable = #{enable,jdbcType=INTEGER},
            </if>
            <if test="firstUpTime != null">
                first_up_time = #{firstUpTime,jdbcType=TIMESTAMP},
            </if>
            <if test="vin != null">
                vin = #{vin,jdbcType=VARCHAR},
            </if>
            <if test="brand != null">
                brand = #{brand,jdbcType=VARCHAR},
            </if>
            <if test="cardTime != null">
                card_time = #{cardTime,jdbcType=VARCHAR},
            </if>
            <if test="createTime != null" >
                create_time = #{createTime,jdbcType=TIMESTAMP},
            </if>
            <if test="closedcarcontract != null" >
                closedcarcontract = #{closedcarcontract,jdbcType=VARCHAR},
            </if>
            <if test="evaluate != null" >
                evaluate = #{evaluate,jdbcType=VARCHAR},
            </if>
            <if test="maintenance != null" >
                maintenance = #{maintenance,jdbcType=VARCHAR},
            </if>
            <if test="evaluatePrice != null" >
                evaluatePrice = #{evaluatePrice,jdbcType=VARCHAR},
            </if>
            <if test="carPicString != null" >
                car_pics = #{carPicString,jdbcType=VARCHAR},
            </if>
            <if test="color != null" >
                color = #{color,jdbcType=VARCHAR},
            </if>
        </set>
        where id = #{id}
    </update>
    <delete id="deleteConsult" parameterType="java.lang.Integer">
        DELETE from carsok_acquisition_consult
        WHERE acquisition_id = #{acquisitionId}
    </delete>

    <delete id="deletePricingInfo" parameterType="java.lang.Integer">
        DELETE from carsok_acquisition_car_pricing
        WHERE acquisition_car_id = #{acquisitionId}
    </delete>

    <select id="selectAliasCustName" resultMap="BaseResultMap">
         SELECT cac.id,
         cac.contentNum,
         cca.alias,
         cca.child_account_mobile AS childPhone,
         ca.account AS account
         FROM carsok_acquisition_car cac
         LEFT JOIN carsok_child_account cca ON cca.id = cac.child_id
         LEFT JOIN carsok_acount ca ON ca.id = cac.account_id
         LEFT JOIN carsok_child_account cca2 ON cca2.account_phone = ca.account
         WHERE cac.isDeal = 2
	     AND DATE_FORMAT(cac.carInspectionTime,'%Y-%m-%d') = DATE_SUB(DATE_FORMAT(NOW(),'%Y%m%d'),INTERVAL 1 DAY)
         GROUP BY cac.id
    </select>

    <select id="selectByIdCount" resultType="java.lang.Integer">
        SELECT COUNT(*) FROM carsok_acquisition_car
        WHERE id = #{otherId}
        <if test="childId == 0">
            AND account_id = #{accountId}
        </if>
        <if test="childId != 0">
            AND account_id = #{accountId} and child_id = #{childId}
        </if>
    </select>
    <select id="selectById" resultMap="BaseResultMap">
        SELECT * FROM carsok_acquisition_car
        WHERE id = #{otherId}
        <if test="childId == 0">
            AND account_id = #{accountId}
        </if>
        <if test="childId != 0">
            AND account_id = #{accountId} and child_id = #{childId}
        </if>
        LIMIT #{p1},#{p2}
    </select>
    <select id="selectIsdeal" resultType="java.lang.Integer">
        SELECT isDeal FROM carsok_acquisition_car
        WHERE id = #{id}

    </select>
    <insert id="insertSxyWb" parameterType="com.uton.carsokApi.model.AcquisitionCar" useGeneratedKeys="true" keyProperty="id">
        insert into carsok_zb_task_sxy_wb
        <trim prefix="(" suffix=")" suffixOverrides="," >
            <if test="id != null" >
                acquisitioncar_id,
            </if>
            <if test="infoRecourse != null" >
                infoSource,
            </if>
            <if test="collectionType != null" >
                carName,
            </if>
            <if test="infoName != null" >
                infoName,
            </if>
            <if test="infoMobile != null" >
                infoMobile,
            </if>
            <if test="customerName != null" >
                selfName,
            </if>
            <if test="contentNum != null" >
                selfMobile,
            </if>
            <if test="vin != null" >
                vin,
            </if>

            <if test="enable != null" >
                enable,
            </if>
            <if test="accountId != 0" >
                acount_id,
            </if>
            <if test="childId != 0" >
                child_id,
            </if>
            task_num,

        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides="," >
            <if test="id != null" >
                #{id,jdbcType=INTEGER},
            </if>
            <if test="infoRecourse != null" >
                2,
            </if>
            <if test="collectionType != null" >
                #{collectionType,jdbcType=VARCHAR},
            </if>
            <if test="infoName != null" >
                #{infoName,jdbcType=INTEGER},
            </if>
            <if test="infoMobile != null" >
                #{infoMobile,jdbcType=VARCHAR},
            </if>
            <if test="customerName != null" >
                #{customerName,jdbcType=VARCHAR},
            </if>
            <if test="contentNum != null" >
                #{contentNum,jdbcType=VARCHAR},
            </if>
            <if test="vin != null" >
                #{vin,jdbcType=VARCHAR},
            </if>
            <if test="enable != null" >
                #{enable,jdbcType=INTEGER},
            </if>
            <if test="accountId != 0" >
                #{accountId,jdbcType=INTEGER},
            </if>
            <if test="childId != 0" >
                #{childId,jdbcType=INTEGER},
            </if>
            #{taskNum,jdbcType=VARCHAR},
        </trim>
    </insert>

    <select id="findNameById" parameterType="java.lang.Integer" resultType="java.lang.String">
    select child_account_name from carsok_child_account where id=#{id}
    </select>

    <select id="findByAcountMobileId" parameterType="java.lang.Integer" resultType="java.lang.String">
        select mobile from carsok_acount where id=#{id}
    </select>

    <select id="findByChildMobileId" parameterType="java.lang.Integer" resultType="java.lang.String">
        select child_account_mobile from carsok_child_account where id=#{id}
    </select>

    <select id="compareWBId" parameterType="java.lang.Integer" resultType="java.lang.Integer">
        select id from carsok_zb_task_sxy_wb where acquisitioncar_id=#{id}
    </select>

    <select id="selectNumber" resultType="java.lang.Integer">
        SELECT count(*) from carsok_acquisition_car
        WHERE 1=1
        <if test="childId == 0">
            AND account_id = #{accountId}
        </if>
        <if test="childId != 0">
            AND account_id = #{accountId} and child_id = #{childId}
        </if>
        <if test="xxly != null and xxly !=''">
            AND infoRecourse = #{xxly}
        </if>
        <if test="cjzt != null and cjzt !=''">
            AND isDeal = #{cjzt}
        </if>
        <if test="type == 1">
            AND DATE_FORMAT(carInspectionTime, '%Y-%m-%d') = (DATE_FORMAT(NOW(), '%Y-%m-%d'))
        </if>
        <if test="type == 2">
            AND carInspectionTime BETWEEN DATE_FORMAT(DATE_SUB(NOW(),INTERVAL WEEKDAY(NOW()) DAY),'%Y-%m-%d') AND DATE_FORMAT(DATE_SUB(CURDATE(),INTERVAL -1 DAY) ,'%Y-%m-%d')
        </if>
        <if test="type == 3">
            AND DATE_FORMAT(carInspectionTime, '%Y-%m') = (DATE_FORMAT(NOW(), '%Y-%m'))
        </if>
        <if test="months != null and months !=''">
            AND DATE_FORMAT(carInspectionTime, '%Y-%m') = (DATE_FORMAT(#{months}, '%Y-%m'))
        </if>
        <if test="selects != null and selects != ''">
            AND ( customerName LIKE CONCAT('%',#{selects},'%')
            OR contentNum LIKE CONCAT('%',#{selects},'%')
            OR collectionType LIKE CONCAT('%',#{selects},'%') )
        </if>
        ORDER BY
        <if test="px == 1">
            preferPrice DESC,
        </if>
        <if test="px == 2">
            preferPrice,
        </if>
            id DESC
    </select>
    <select id="querySelectList" resultMap="BaseResultMap">
        SELECT * from carsok_acquisition_car
        WHERE 1=1
        <if test="childId == 0">
            AND account_id = #{accountId}
        </if>
      <!--  <if test="childId != 0">
            AND account_id = #{accountId} and child_id = #{childId}
        </if>-->
        <if test="childId != 0 and flage == 0">
            AND account_id = #{accountId} and child_id = #{childId}
        </if>
        <if test="childId != 0 and flage == 1">
            AND account_id = #{accountId}
        </if>
        <if test="xxly != null and xxly !=''">
            AND infoRecourse = #{xxly}
        </if>
        <if test="cjzt != null and cjzt !=''">
            AND isDeal = #{cjzt}
        </if>
        <if test="type == '1'.toString()">
            AND DATE_FORMAT(carInspectionTime, '%Y-%m-%d') = (DATE_FORMAT(NOW(), '%Y-%m-%d'))
        </if>
        <if test="type == '2'.toString()">
            AND carInspectionTime BETWEEN DATE_FORMAT(DATE_SUB(NOW(),INTERVAL WEEKDAY(NOW()) DAY),'%Y-%m-%d') AND DATE_FORMAT(DATE_SUB(CURDATE(),INTERVAL -1 DAY) ,'%Y-%m-%d')
        </if>
        <if test="type == '3'.toString()">
            AND DATE_FORMAT(carInspectionTime, '%Y-%m') = (DATE_FORMAT(NOW(), '%Y-%m'))
        </if>
        <if test="months != null and months !=''">
            AND DATE_FORMAT(carInspectionTime, '%Y-%m') = (DATE_FORMAT(#{months}, '%Y-%m'))
        </if>
        <if test="selects != null and selects != ''">
            AND ( customerName LIKE CONCAT('%',#{selects},'%')
            OR contentNum LIKE CONCAT('%',#{selects},'%')
            OR collectionType LIKE CONCAT('%',#{selects},'%') )
        </if>
        ORDER BY
        <if test="px == '1'.toString()">
            preferPrice DESC,
        </if>
        <if test="px == '2'.toString()">
            preferPrice,
        </if>
        id DESC
        LIMIT #{p1},#{p2}
    </select>
    <select id="selectDay" resultType="java.lang.Integer">
        SELECT COUNT(*) from carsok_acquisition_car
        WHERE 1=1
        AND DATE_FORMAT(carInspectionTime, '%Y-%m-%d') = (DATE_FORMAT(NOW(), '%Y-%m-%d'))
        <if test="childId == 0">
            AND account_id = #{accountId}
        </if>
        <!-- <if test="childId != 0">
         AND account_id = #{accountId} and child_id = #{childId}
        </if>-->
        <if test="childId != 0 and flage == 0">
            AND account_id = #{accountId} and child_id = #{childId}
        </if>
        <if test="childId != 0 and flage == 1">
            AND account_id = #{accountId}
        </if>
    </select>
    <select id="selectWeek" resultType="java.lang.Integer">
        SELECT COUNT(*) from carsok_acquisition_car
        WHERE 1=1
        AND carInspectionTime BETWEEN DATE_FORMAT(DATE_SUB(NOW(),INTERVAL WEEKDAY(NOW()) DAY),'%Y-%m-%d') AND DATE_FORMAT(DATE_SUB(CURDATE(),INTERVAL -1 DAY) ,'%Y-%m-%d')
        <if test="childId == 0">
            AND account_id = #{accountId}
        </if>
       <!-- <if test="childId != 0">
            AND account_id = #{accountId} and child_id = #{childId}
        </if>-->
        <if test="childId != 0 and flage == 0">
            AND account_id = #{accountId} and child_id = #{childId}
        </if>
        <if test="childId != 0 and flage == 1">
            AND account_id = #{accountId}
        </if>
    </select>
    <select id="selectMonth" resultType="java.lang.Integer">
        SELECT COUNT(*) from carsok_acquisition_car
        WHERE 1=1
        AND DATE_FORMAT(carInspectionTime, '%Y-%m') = (DATE_FORMAT(NOW(), '%Y-%m'))
        <if test="childId == 0">
            AND account_id = #{accountId}
        </if>
      <!--  <if test="childId != 0">
            AND account_id = #{accountId} and child_id = #{childId}
        </if>-->
        <if test="childId != 0 and flage == 0">
            AND account_id = #{accountId} and child_id = #{childId}
        </if>
        <if test="childId != 0 and flage == 1">
            AND account_id = #{accountId}
        </if>
    </select>

    <select id="selectSCSF" parameterType="java.lang.Integer" resultMap="BaseResultMap3">
      select power_name FROM carsok_account_power where child_id = #{childId}
    </select>
    <select id="selectContract" resultType="java.lang.String">

        SELECT
	cac.closedcarcontract
FROM
	carsok_acquisition_car cac
LEFT JOIN carsok_zb_task_sxy_wb zb ON cac.id = zb.acquisitioncar_id
WHERE
	zb.task_id = #{id}
	and zb.task_id!=0

    </select>
</mapper>